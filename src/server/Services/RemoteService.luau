--[[
	RemoteService
	Gestion centralis√©e de tous les RemoteEvents
	Cr√©√© au d√©marrage du serveur et accessible par tous les modules
]]

local ReplicatedStorage = game:GetService("ReplicatedStorage")

local RemoteService = {}
RemoteService.Remotes = {}

-- Initialiser tous les RemoteEvents
function RemoteService:Init()
	print("üîå Initialisation RemoteService...")

	-- Cr√©er le dossier principal
	local remoteFolder = Instance.new("Folder")
	remoteFolder.Name = "Remotes"
	remoteFolder.Parent = ReplicatedStorage

	-- D√©finir tous les remotes n√©cessaires
	local remoteNames = {
		"CoinCollected",      -- Quand un joueur collecte une pi√®ce
		"GameEnded",          -- Quand la partie se termine
		"CompassToggle",      -- Toggle de la boussole
		"RoundStateChanged",  -- Changement d'√©tat du round
		"DoorTeleport",       -- T√©l√©portation via porte
	}

	-- Cr√©er chaque RemoteEvent
	for _, remoteName in ipairs(remoteNames) do
		local remoteEvent = Instance.new("RemoteEvent")
		remoteEvent.Name = remoteName
		remoteEvent.Parent = remoteFolder

		self.Remotes[remoteName] = remoteEvent
		print("  ‚úÖ RemoteEvent cr√©√©:", remoteName)
	end

	print("‚úÖ RemoteService initialis√© - " .. #remoteNames .. " remotes cr√©√©s")
	return self
end

-- R√©cup√©rer un remote sp√©cifique
function RemoteService:Get(remoteName)
	local remote = self.Remotes[remoteName]
	if not remote then
		warn("‚ö†Ô∏è RemoteEvent introuvable:", remoteName)
	end
	return remote
end

-- Fire √† tous les clients
function RemoteService:FireAllClients(remoteName, ...)
	local remote = self:Get(remoteName)
	if remote then
		remote:FireAllClients(...)
	end
end

-- Fire √† un client sp√©cifique
function RemoteService:FireClient(remoteName, player, ...)
	local remote = self:Get(remoteName)
	if remote then
		remote:FireClient(player, ...)
	end
end

-- Connecter un handler √† un remote
function RemoteService:OnServerEvent(remoteName, handler)
	local remote = self:Get(remoteName)
	if remote then
		remote.OnServerEvent:Connect(handler)
	end
end

return RemoteService
